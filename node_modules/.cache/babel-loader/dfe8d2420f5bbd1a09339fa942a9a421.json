{"ast":null,"code":"var _jsxFileName = \"/home/ironhacker/Documents/M3/droy/src/contexts/dataContext.js\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport api from '../services/apiClient';\nconst DataContext = React.createContext(); // Consumer Wrapper\n\nexport const withData = Comp => {\n  return class WithData extends Component {\n    render() {\n      return /*#__PURE__*/React.createElement(DataContext.Consumer, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 12,\n          columnNumber: 9\n        }\n      }, props => /*#__PURE__*/React.createElement(Comp, Object.assign({}, this.props, props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 13,\n          columnNumber: 24\n        }\n      })));\n    }\n\n  };\n}; // Provider def\n\nclass DataProvider extends Component {\n  constructor(props) {\n    super(props);\n\n    this.switchMode = () => {\n      const {\n        mode\n      } = this.state;\n      this.setState({\n        mode: mode === 'edit' ? 'view' : 'edit'\n      });\n    };\n\n    this.deleteComponent = elementCode => {\n      const stateCopy = { ...this.state\n      };\n      const {\n        userLayoutObj: newUserLayoutObj\n      } = stateCopy;\n      let fromIndex = 0;\n\n      for (let i = 0; i < newUserLayoutObj.length; i++) {\n        const c = newUserLayoutObj[i];\n\n        if (c.code === elementCode) {\n          fromIndex = i;\n          break;\n        }\n      }\n\n      newUserLayoutObj.splice(fromIndex, 1);\n      this.setState({\n        userLayoutObj: newUserLayoutObj\n      });\n    };\n\n    this.getStyleComponents = async () => {\n      try {\n        const {\n          style\n        } = this.state;\n        const {\n          data: styleComponents\n        } = await api.get(`/components?style=${style}`);\n        console.log(styleComponents);\n        this.setState({\n          styleComponents\n        });\n      } catch (error) {\n        this.setState({\n          dataError: \"Unable to get your project data\"\n        });\n      }\n    };\n\n    this.moveDownComponent = elementCode => {\n      const stateCopy = { ...this.state\n      };\n      const {\n        userLayoutObj: newUserLayoutObj\n      } = stateCopy;\n      let fromIndex = 0;\n      let element;\n\n      for (let i = 0; i < newUserLayoutObj.length; i++) {\n        const c = newUserLayoutObj[i];\n\n        if (c.code === elementCode) {\n          element = c;\n          fromIndex = i;\n          break;\n        }\n      }\n\n      newUserLayoutObj.splice(fromIndex, 1);\n      newUserLayoutObj.splice(fromIndex + 1, 0, element);\n      this.setState({\n        userLayoutObj: newUserLayoutObj\n      });\n    };\n\n    this.saveComponentInfoToContext = (componentCode, componentAttr, attrContent) => {\n      const stateCopy = { ...this.state\n      };\n      const {\n        userLayoutObj: newUserLayoutObj\n      } = stateCopy;\n\n      for (const userObject of newUserLayoutObj) {\n        if (userObject.code === componentCode) {\n          userObject.info[componentAttr] = attrContent;\n        }\n      }\n\n      this.setState({\n        userLayoutObj: newUserLayoutObj\n      });\n    };\n\n    this.save = () => {\n      console.log(\"Saving info:\", this.state.userLayoutObj);\n    };\n\n    this.addComponent = (componentCode, defaultInfo) => {\n      const stateCopy = { ...this.state\n      };\n      stateCopy.userLayoutObj.push({\n        code: componentCode,\n        info: JSON.parse(defaultInfo)\n      });\n      this.setState({\n        userLayoutObj: stateCopy.userLayoutObj\n      });\n    };\n\n    this.getProjectInfo = async projectId => {\n      console.log('in get project info');\n\n      try {\n        const {\n          data: {\n            componentsConfiguration,\n            style\n          }\n        } = await api.get(`/projects/${projectId}`);\n        this.setState({\n          userLayoutObj: componentsConfiguration,\n          projectStyle: style\n        });\n      } catch (error) {\n        this.setState({\n          dataError: \"Unable to get your project data\"\n        });\n      }\n    };\n\n    this.state = {\n      mode: 'edit',\n      userLayoutObj: [],\n      projectStyle: \"\",\n      dataError: \"\",\n      styleComponents: []\n    };\n  }\n  /* SWITCH MODES */\n\n\n  render() {\n    const {\n      children\n    } = this.props;\n    return /*#__PURE__*/React.createElement(DataContext.Provider, {\n      value: {\n        getProjectInfo: this.getProjectInfo,\n        getUserLayoutObj: this.getUserLayoutObj,\n        copyUserLayoutObjToContext: this.copyUserLayoutObjToContext,\n        switchMode: this.switchMode,\n        moveDownComponent: this.moveDownComponent,\n        addComponent: this.addComponent,\n        deleteComponent: this.deleteComponent,\n        getStyleComponents: this.getStyleComponents,\n        save: this.save,\n        ...this.state\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 7\n      }\n    }, children);\n  }\n\n}\n\nDataProvider.propTypes = {\n  children: PropTypes.node\n};\nexport default DataProvider;","map":{"version":3,"sources":["/home/ironhacker/Documents/M3/droy/src/contexts/dataContext.js"],"names":["React","Component","PropTypes","api","DataContext","createContext","withData","Comp","WithData","render","props","DataProvider","constructor","switchMode","mode","state","setState","deleteComponent","elementCode","stateCopy","userLayoutObj","newUserLayoutObj","fromIndex","i","length","c","code","splice","getStyleComponents","style","data","styleComponents","get","console","log","error","dataError","moveDownComponent","element","saveComponentInfoToContext","componentCode","componentAttr","attrContent","userObject","info","save","addComponent","defaultInfo","push","JSON","parse","getProjectInfo","projectId","componentsConfiguration","projectStyle","children","getUserLayoutObj","copyUserLayoutObjToContext","propTypes","node"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport PropTypes from 'prop-types'\nimport api from '../services/apiClient'\n\nconst DataContext = React.createContext()\n\n// Consumer Wrapper\nexport const withData = (Comp) => {\n  return class WithData extends Component {\n    render () {\n      return (\n        <DataContext.Consumer>\n          { (props) => <Comp {...this.props} {...props} /> }\n        </DataContext.Consumer>\n      )\n    }\n  }\n}\n\n// Provider def\nclass DataProvider extends Component {\n\n  constructor(props){\n    super(props)\n    this.state = {\n      mode: 'edit',\n      userLayoutObj: [],\n      projectStyle: \"\",\n      dataError: \"\",\n      styleComponents: []\n    }\n  }\n\n  /* SWITCH MODES */\n  switchMode = () => {\n    const { mode } = this.state\n    this.setState({ mode: mode === 'edit' ? 'view': 'edit' })\n  }\n\n  deleteComponent = (elementCode) => {\n    const stateCopy = {...this.state}\n    const { userLayoutObj: newUserLayoutObj } = stateCopy\n    let fromIndex = 0;\n    for (let i = 0; i < newUserLayoutObj.length; i++) {\n      const c = newUserLayoutObj[i];\n      if(c.code === elementCode) {\n        fromIndex = i; break\n      }\n    }\n    newUserLayoutObj.splice(fromIndex, 1)\n    this.setState({ userLayoutObj: newUserLayoutObj })\n  }\n\n  getStyleComponents = async () => {\n    try {\n      const { style } = this.state\n      const { data: styleComponents } = await api.get(`/components?style=${style}`)\n      console.log(styleComponents)\n      this.setState({ styleComponents })\n    } catch (error) {\n      this.setState({ dataError: \"Unable to get your project data\" })\n    }\n  }\n\n  moveDownComponent = (elementCode) => {\n    const stateCopy = {...this.state}\n    const { userLayoutObj: newUserLayoutObj } = stateCopy\n    let fromIndex = 0; let element\n    for (let i = 0; i < newUserLayoutObj.length; i++) {\n      const c = newUserLayoutObj[i];\n      if(c.code === elementCode) {\n        element = c; fromIndex = i; break\n      }\n    }\n    newUserLayoutObj.splice(fromIndex, 1)\n    newUserLayoutObj.splice(fromIndex + 1, 0, element)\n    this.setState({ userLayoutObj: newUserLayoutObj })\n  }\n\n  saveComponentInfoToContext = (componentCode, componentAttr, attrContent) => {\n    const stateCopy = {...this.state}\n    const { userLayoutObj: newUserLayoutObj } = stateCopy\n    for (const userObject of newUserLayoutObj) {\n      if(userObject.code === componentCode) {\n        userObject.info[componentAttr] = attrContent\n      }\n    }\n    this.setState({\n      userLayoutObj: newUserLayoutObj\n    })\n  };\n\n  save = () => {\n    console.log(\"Saving info:\", this.state.userLayoutObj)\n  }\n\n  addComponent = (componentCode, defaultInfo) => {\n    const stateCopy = {...this.state}\n    stateCopy.userLayoutObj.push({\n      code: componentCode,\n      info: JSON.parse(defaultInfo)\n    })\n    this.setState({\n      userLayoutObj: stateCopy.userLayoutObj\n    })\n  }\n\n  getProjectInfo = async (projectId) => {\n    console.log('in get project info')\n    try {\n      const { data: { componentsConfiguration, style } } = await api.get(`/projects/${projectId}`)\n      this.setState({ userLayoutObj: componentsConfiguration, projectStyle: style })\n    } catch (error) {\n      this.setState({ dataError: \"Unable to get your project data\" })\n    }\n  }\n\n  render () {\n    const { children } = this.props\n    \n    return (\n      <DataContext.Provider value={{\n        getProjectInfo: this.getProjectInfo,\n        getUserLayoutObj: this.getUserLayoutObj,\n        copyUserLayoutObjToContext: this.copyUserLayoutObjToContext,\n        switchMode: this.switchMode,\n        moveDownComponent: this.moveDownComponent,\n        addComponent: this.addComponent,\n        deleteComponent: this.deleteComponent,\n        getStyleComponents: this.getStyleComponents,\n        save: this.save,\n        ...this.state\n        \n      }}>\n        {children}\n      </DataContext.Provider>\n    )\n  }\n}\n\nDataProvider.propTypes = {\n  children: PropTypes.node\n}\n\nexport default DataProvider\n"]},"metadata":{},"sourceType":"module"}