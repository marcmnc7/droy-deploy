{"ast":null,"code":"var _jsxFileName = \"/home/ironhacker/Documents/M3/droy/src/pages/Builder.js\";\nimport React, { Component } from 'react';\nimport { withData } from '../contexts/dataContext';\nimport PropTypes from 'prop-types';\nimport UserComponentBase from '../components/droy/UserComponentBase';\nimport ComponentsSelectorBar from '../components/droy/ComponentsSelectorBar';\nimport NavBar from '../components/droy/NavBar';\nimport Loading from '../components/droy/Loading';\nimport '../styles/builder.css';\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\n\nclass Builder extends Component {\n  constructor(props) {\n    super(props);\n\n    this.reorder = (list, startIndex, endIndex) => {\n      const result = Array.from(list);\n      const [removed] = result.splice(startIndex, 1);\n      result.splice(endIndex, 0, removed);\n      return result;\n    };\n\n    this.onDragEnd = result => {\n      const {\n        userLayoutObj,\n        updateOrder\n      } = this.props;\n\n      if (result.destination) {\n        const items = this.reorder(userLayoutObj, result.source.index, result.destination.index);\n        updateOrder(items);\n      }\n    };\n\n    this.componentDidMount = async () => {\n      const {\n        match,\n        getProjectInfo\n      } = this.props;\n      await getProjectInfo(match.params.projectId);\n      this.setState({\n        isLoading: false\n      });\n    };\n\n    this.showUserComponents = () => {\n      const {\n        userLayoutObj,\n        dataError,\n        history\n      } = this.props;\n\n      if (!userLayoutObj) {\n        history.push('/');\n        return;\n      }\n\n      if (!userLayoutObj.length) return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"empty-component-base\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"image-emptyBuilder\",\n        src: \"/img/empty-icon.png\",\n        alt: \"empty-icon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"text-noComponents\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 9\n        }\n      }, \"Start picking one component from the left!\"));\n      const allComponents = [];\n\n      if (this.props.mode === 'edit') {\n        let i = 0;\n\n        for (const c of userLayoutObj) {\n          allComponents.push( /*#__PURE__*/React.createElement(Draggable, {\n            key: c.code,\n            draggableId: c.code,\n            index: i,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 65,\n              columnNumber: 11\n            }\n          }, (provided, snapshot) => /*#__PURE__*/React.createElement(\"div\", Object.assign({\n            ref: provided.innerRef\n          }, provided.draggableProps, provided.dragHandleProps, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 67,\n              columnNumber: 15\n            }\n          }), /*#__PURE__*/React.createElement(UserComponentBase, {\n            componentStyle: c.componentStyle,\n            componentOptions: c.componentOptions,\n            code: c.code,\n            key: c.code,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 68,\n              columnNumber: 17\n            }\n          }))));\n          i += 1;\n        }\n\n        return /*#__PURE__*/React.createElement(Droppable, {\n          key: i,\n          droppableId: \"droppable\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 9\n          }\n        }, (provided, snapshot) => /*#__PURE__*/React.createElement(\"div\", Object.assign({}, provided.droppableProps, {\n          ref: provided.innerRef,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 13\n          }\n        }), [...allComponents], provided.placeholder));\n      } else {\n        return userLayoutObj.map(c => {\n          return /*#__PURE__*/React.createElement(UserComponentBase, {\n            componentStyle: c.componentStyle,\n            componentOptions: c.componentOptions,\n            code: c.code,\n            key: c.code,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 16\n            }\n          });\n        });\n      }\n    };\n\n    this.state = {\n      isLoading: true\n    };\n  }\n  /* Drag Reorder components  */\n\n\n  render() {\n    const {\n      mode\n    } = this.props;\n    const {\n      isLoading\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(NavBar, {\n      withOptions: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"main-builder\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }\n    }, isLoading && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loading-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Loading, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 60\n      }\n    })), !isLoading && mode === \"edit\" && /*#__PURE__*/React.createElement(ComponentsSelectorBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 45\n      }\n    }), /*#__PURE__*/React.createElement(DragDropContext, {\n      onDragEnd: this.onDragEnd,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }\n    }, !isLoading && /*#__PURE__*/React.createElement(\"div\", {\n      className: \"components-builder\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 28\n      }\n    }, this.showUserComponents()))));\n  }\n\n}\n\nBuilder.propTypes = {\n  userLayoutObj: PropTypes.array,\n  saveInfoToContext: PropTypes.func\n};\nexport default withData(Builder);","map":{"version":3,"sources":["/home/ironhacker/Documents/M3/droy/src/pages/Builder.js"],"names":["React","Component","withData","PropTypes","UserComponentBase","ComponentsSelectorBar","NavBar","Loading","DragDropContext","Droppable","Draggable","Builder","constructor","props","reorder","list","startIndex","endIndex","result","Array","from","removed","splice","onDragEnd","userLayoutObj","updateOrder","destination","items","source","index","componentDidMount","match","getProjectInfo","params","projectId","setState","isLoading","showUserComponents","dataError","history","push","length","allComponents","mode","i","c","code","provided","snapshot","innerRef","draggableProps","dragHandleProps","componentStyle","componentOptions","droppableProps","placeholder","map","state","render","propTypes","array","saveInfoToContext","func"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { withData } from '../contexts/dataContext'\nimport PropTypes from 'prop-types'\nimport UserComponentBase from '../components/droy/UserComponentBase'\nimport ComponentsSelectorBar from '../components/droy/ComponentsSelectorBar'\nimport NavBar from '../components/droy/NavBar'\nimport Loading from '../components/droy/Loading'\nimport '../styles/builder.css'\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\n\n\nclass Builder extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      isLoading: true\n    }\n  }\n\n  /* Drag Reorder components  */\n  reorder = (list, startIndex, endIndex) => {\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    return result;\n  };\n\n  onDragEnd = (result) => {\n    const { userLayoutObj, updateOrder } = this.props\n    if (result.destination) {\n      const items = this.reorder(\n        userLayoutObj,\n        result.source.index,\n        result.destination.index\n      )\n      updateOrder(items)\n    }\n  }\n\n  /* Updates data context with the actual project information */\n  componentDidMount = async () => {\n    const { match, getProjectInfo } = this.props\n    await getProjectInfo(match.params.projectId)\n    this.setState({ isLoading: false })\n  }\n\n  /* Loops over project info in data context to print user components */\n  /* If not components found, prints a pretty message */\n  showUserComponents = () => {\n    const { userLayoutObj, dataError, history } = this.props\n    if (!userLayoutObj){\n      history.push('/')\n      return\n    }\n    if (!userLayoutObj.length) return (\n      <div className='empty-component-base'>\n        <img className='image-emptyBuilder' src='/img/empty-icon.png' alt='empty-icon' />\n        <p className='text-noComponents'>Start picking one component from the left!</p>\n      </div>)\n    const allComponents = []\n    if (this.props.mode === 'edit') {\n      let i = 0\n      for (const c of userLayoutObj) {\n        allComponents.push(\n          <Draggable key={c.code} draggableId={c.code} index={i}>\n            {(provided, snapshot) => (\n              <div ref={provided.innerRef} {...provided.draggableProps} {...provided.dragHandleProps}>\n                <UserComponentBase componentStyle={c.componentStyle} componentOptions={c.componentOptions} code={c.code} key={c.code} />\n              </div>\n            )}\n          </Draggable>\n        )\n        i += 1\n      }\n      return (\n        <Droppable key={i} droppableId=\"droppable\">\n          {(provided, snapshot) => (\n            <div {...provided.droppableProps} ref={provided.innerRef}>\n              {[...allComponents]}\n              {provided.placeholder}\n            </div>\n          )}\n        </Droppable>)\n    } else {\n      return userLayoutObj.map(c => {\n        return <UserComponentBase componentStyle={c.componentStyle} componentOptions={c.componentOptions} code={c.code} key={c.code} />\n      })\n    }\n  }\n\n  render() {\n    const { mode } = this.props\n    const { isLoading } = this.state\n    return (\n      <div>\n        <NavBar withOptions />\n        <div className=\"main-builder\">\n          {isLoading && <div className='loading-container'><Loading /></div>}\n          {!isLoading && mode === \"edit\" && <ComponentsSelectorBar />}\n          <DragDropContext onDragEnd={this.onDragEnd}>\n            {!isLoading && <div className=\"components-builder\">{this.showUserComponents()}</div>}\n          </DragDropContext>\n\n        </div>\n      </div>\n    )\n  }\n}\n\nBuilder.propTypes = {\n  userLayoutObj: PropTypes.array,\n  saveInfoToContext: PropTypes.func\n}\n\nexport default withData(Builder)\n"]},"metadata":{},"sourceType":"module"}