{"ast":null,"code":"import _regeneratorRuntime from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import NavBar from'../components/droy/NavBar';import ModalStartPage from'../components/droy/ModalStartProject';import ModalDelete from'../components/droy/ModalDelete';import SquareProject from'../components/droy/SquareProject';import Loading from'../components/droy/Loading';import Error from'../components/droy/Error';import'../styles/homePage.css';import api from'../services/apiClient';import firebase from'../services/firebase';var STATUS={LOADING:'LOADING',LOADED:'LOADED',ERROR:'ERROR'};var Homepage=/*#__PURE__*/function(_Component){_inherits(Homepage,_Component);var _super=_createSuper(Homepage);function Homepage(props){var _this;_classCallCheck(this,Homepage);_this=_super.call(this,props);_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,styles,projects;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([api.get('/styles'),api.get(\"/projects/user/\".concat(firebase.auth().currentUser.uid))]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);styles=_yield$Promise$all2[0].data;projects=_yield$Promise$all2[1].data;_this.setState({styles:styles,allProjects:projects,status:STATUS.LOADED});_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);_this.setState({status:STATUS.ERROR});case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));_this.showModalDelete=function(e){var allProjects=_this.state.allProjects;var targetProject=e.target.attributes['data-project'];targetProject=allProjects.find(function(p){return p._id===targetProject.value;});_this.setState({modalDelete:{show:true,data:targetProject},modalStart:false});};_this.closeModalDelete=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$api$get,projects;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return api.get(\"/projects/user/\".concat(firebase.auth().currentUser.uid));case 3:_yield$api$get=_context2.sent;projects=_yield$api$get.data;_this.setState({modalDelete:{show:false,data:''},allProjects:projects});_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);_this.setState({status:STATUS.ERROR});case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));_this.showModalStart=function(){_this.setState({modalDelete:{show:false,data:''},modalStart:true});};_this.closeModalStart=function(){_this.setState({modalStart:false});};_this.state={modalDelete:{show:'',data:''},modalStart:false,styles:[],allProjects:[],status:STATUS.LOADING};return _this;}/* Gets all the available styles and the projects of this user and store it to the state*/_createClass(Homepage,[{key:\"showContent\",value:function showContent(){var _this2=this;var _this$state=this.state,status=_this$state.status,styles=_this$state.styles,modalStart=_this$state.modalStart,modalDelete=_this$state.modalDelete,allProjects=_this$state.allProjects;switch(status){case STATUS.LOADING:return/*#__PURE__*/React.createElement(\"div\",{className:\"loading-container\"},/*#__PURE__*/React.createElement(Loading,null));case STATUS.LOADED:return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",{className:\"title-homePage\"},\"Create a project:\"),/*#__PURE__*/React.createElement(\"img\",{className:\"buttons-homePage\",onClick:this.showModalStart,src:\"../../img/sum-icon.png\",alt:\"create-project\"}),modalStart&&/*#__PURE__*/React.createElement(ModalStartPage,{styles:styles,onClose:this.closeModalStart}),modalDelete.show&&/*#__PURE__*/React.createElement(ModalDelete,{onClose:this.closeModalDelete,project:modalDelete.data}),allProjects.length>0&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",{className:\"title-homePage\"},\"Select the project you want to open:\"),/*#__PURE__*/React.createElement(\"div\",{className:\"all-projects-homePage\"},allProjects.map(function(project,key){return/*#__PURE__*/React.createElement(SquareProject,{key:key,project:project,showModalDelete:_this2.showModalDelete});}))));case STATUS.ERROR:return/*#__PURE__*/React.createElement(\"div\",null,\" \",/*#__PURE__*/React.createElement(Error,null),\" \");default:break;}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"homePage-container\"},/*#__PURE__*/React.createElement(NavBar,null),this.showContent());}}]);return Homepage;}(Component);export default Homepage;","map":{"version":3,"sources":["/home/ironhacker/Documents/M3/droy/src/pages/Homepage.js"],"names":["React","Component","NavBar","ModalStartPage","ModalDelete","SquareProject","Loading","Error","api","firebase","STATUS","LOADING","LOADED","ERROR","Homepage","props","componentDidMount","Promise","all","get","auth","currentUser","uid","styles","data","projects","setState","allProjects","status","showModalDelete","e","state","targetProject","target","attributes","find","p","_id","value","modalDelete","show","modalStart","closeModalDelete","showModalStart","closeModalStart","length","map","project","key","showContent"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport NavBar from '../components/droy/NavBar'\nimport ModalStartPage from '../components/droy/ModalStartProject'\nimport ModalDelete from '../components/droy/ModalDelete'\nimport SquareProject from '../components/droy/SquareProject'\nimport Loading from '../components/droy/Loading'\nimport Error from '../components/droy/Error'\nimport '../styles/homePage.css'\nimport api from '../services/apiClient'\nimport firebase from '../services/firebase'\n\nconst STATUS = {\n  LOADING: 'LOADING',\n  LOADED: 'LOADED',\n  ERROR: 'ERROR',\n}\n\nclass Homepage extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      modalDelete: { show: '', data: '' },\n      modalStart: false,\n      styles: [],\n      allProjects: [],\n      status: STATUS.LOADING\n    }\n  }\n\n  /* Gets all the available styles and the projects of this user and store it to the state*/\n  componentDidMount = async () => {\n    try {\n      const [{ data: styles }, { data: projects }] = await Promise.all([\n        api.get('/styles'),\n        api.get(`/projects/user/${firebase.auth().currentUser.uid}`)\n      ])\n      this.setState({\n        styles: styles,\n        allProjects: projects,\n        status: STATUS.LOADED,\n      })      \n    } catch (error) {\n      this.setState({ status: STATUS.ERROR })\n    }\n  }\n\n  /* Opens the delete project modal setting the target to the state */\n  showModalDelete = (e) => {\n    const { allProjects } = this.state\n    let targetProject = e.target.attributes['data-project']\n    targetProject = allProjects.find(p => p._id === targetProject.value)\n    this.setState({\n      modalDelete: {\n        show: true,\n        data: targetProject\n      },\n      modalStart: false\n    })\n  }\n\n  /* Closes the delete project modal and refresh data */\n  closeModalDelete = async () => {\n    try {\n      const { data: projects } = await api.get(`/projects/user/${firebase.auth().currentUser.uid}`)\n      this.setState({\n        modalDelete: {\n          show: false,\n          data: ''\n        },\n        allProjects: projects,\n      })\n    } catch (error) {\n      this.setState({ status: STATUS.ERROR })\n    }\n  }\n\n  /* Opens the start project modal */\n  showModalStart = () => {\n    this.setState({\n      modalDelete: { show: false, data: '' },\n      modalStart: true\n    })\n  }\n\n  /* Close the start project modal */\n  closeModalStart = () => {\n    this.setState({\n      modalStart: false\n    })\n  }\n\n  showContent() {\n    const { status, styles, modalStart, modalDelete, allProjects } = this.state\n    switch (status) {\n      case STATUS.LOADING:\n        return <div className='loading-container'><Loading /></div>\n      case STATUS.LOADED:\n        return (\n          <div>\n            <h2 className='title-homePage'>Create a project:</h2>\n            <img className='buttons-homePage' onClick={this.showModalStart} src=\"../../img/sum-icon.png\" alt='create-project'/>\n            {modalStart && <ModalStartPage styles={styles} onClose={this.closeModalStart} />}\n            {modalDelete.show && <ModalDelete onClose={this.closeModalDelete} project={modalDelete.data} />}\n            {allProjects.length > 0 &&\n              <div>\n                <h2 className='title-homePage'>Select the project you want to open:</h2>\n                <div className='all-projects-homePage'>\n                  {allProjects.map((project, key) => <SquareProject key={key} project={project} showModalDelete={this.showModalDelete} />)}\n                </div>\n              </div>\n            }\n          </div>\n        )\n      case STATUS.ERROR:\n        return <div> <Error /> </div>\n\n      default:\n        break;\n    }\n\n  }\n\n  render() {\n    return (\n      <div className='homePage-container'>\n        <NavBar />\n        {this.showContent()}\n      </div>\n    )\n\n  }\n}\n\nexport default Homepage\n"]},"metadata":{},"sourceType":"module"}