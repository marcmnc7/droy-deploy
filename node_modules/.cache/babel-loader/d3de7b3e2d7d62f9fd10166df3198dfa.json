{"ast":null,"code":"import _createForOfIteratorHelper from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ironhacker/Documents/M3/droy/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{withData}from'../contexts/dataContext';import UserComponentBase from'../components/droy/UserComponentBase';import ComponentsSelectorBar from'../components/droy/ComponentsSelectorBar';import NavBar from'../components/droy/NavBar';import Loading from'../components/droy/Loading';import'../styles/builder.css';import{DragDropContext,Droppable,Draggable}from\"react-beautiful-dnd\";var Builder=/*#__PURE__*/function(_Component){_inherits(Builder,_Component);var _super=_createSuper(Builder);function Builder(props){var _this;_classCallCheck(this,Builder);_this=_super.call(this,props);_this.reorder=function(list,startIndex,endIndex){var result=Array.from(list);var _result$splice=result.splice(startIndex,1),_result$splice2=_slicedToArray(_result$splice,1),removed=_result$splice2[0];result.splice(endIndex,0,removed);return result;};_this.onDragEnd=function(result){var _this$props=_this.props,userLayoutObj=_this$props.userLayoutObj,updateOrder=_this$props.updateOrder;if(result.destination){var items=_this.reorder(userLayoutObj,result.source.index,result.destination.index);updateOrder(items);}};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this$props2,match,getProjectInfo;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this$props2=_this.props,match=_this$props2.match,getProjectInfo=_this$props2.getProjectInfo;_context.next=3;return getProjectInfo(match.params.projectId);case 3:_this.setState({isLoading:false});case 4:case\"end\":return _context.stop();}}},_callee);}));_this.showUserComponents=function(){var _this$props3=_this.props,userLayoutObj=_this$props3.userLayoutObj,dataError=_this$props3.dataError;if(!userLayoutObj.length)return/*#__PURE__*/React.createElement(\"div\",{className:\"empty-component-base\"},/*#__PURE__*/React.createElement(\"img\",{className:\"image-emptyBuilder\",src:\"/img/empty-icon.png\",alt:\"empty-icon\"}),/*#__PURE__*/React.createElement(\"p\",{className:\"text-noComponents\"},\"Start picking one component from the left!\"));if(dataError)return/*#__PURE__*/React.createElement(\"div\",null,dataError);var allComponents=[];if(_this.props.mode==='edit'){var i=0;var _iterator=_createForOfIteratorHelper(userLayoutObj),_step;try{var _loop=function _loop(){var c=_step.value;allComponents.push(/*#__PURE__*/React.createElement(Draggable,{key:c.code,draggableId:c.code,index:i},function(provided,snapshot){return/*#__PURE__*/React.createElement(\"div\",Object.assign({ref:provided.innerRef},provided.draggableProps,provided.dragHandleProps),/*#__PURE__*/React.createElement(UserComponentBase,{componentStyle:c.componentStyle,componentOptions:c.componentOptions,code:c.code,key:c.code}));}));i+=1;};for(_iterator.s();!(_step=_iterator.n()).done;){_loop();}}catch(err){_iterator.e(err);}finally{_iterator.f();}return/*#__PURE__*/React.createElement(Droppable,{key:i,droppableId:\"droppable\"},function(provided,snapshot){return/*#__PURE__*/React.createElement(\"div\",Object.assign({},provided.droppableProps,{ref:provided.innerRef}),[].concat(allComponents),provided.placeholder);});}else{return userLayoutObj.map(function(c){return/*#__PURE__*/React.createElement(UserComponentBase,{componentStyle:c.componentStyle,componentOptions:c.componentOptions,code:c.code,key:c.code});});}};_this.state={isLoading:true};return _this;}// a little function to help us with reordering the result\n_createClass(Builder,[{key:\"render\",value:function render(){var mode=this.props.mode;var isLoading=this.state.isLoading;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(NavBar,{withOptions:true}),/*#__PURE__*/React.createElement(\"div\",{className:\"main-builder\"},isLoading&&/*#__PURE__*/React.createElement(\"div\",{className:\"loading-container\"},/*#__PURE__*/React.createElement(Loading,null)),!isLoading&&mode===\"edit\"&&/*#__PURE__*/React.createElement(ComponentsSelectorBar,null),/*#__PURE__*/React.createElement(DragDropContext,{onDragEnd:this.onDragEnd},!isLoading&&/*#__PURE__*/React.createElement(\"div\",{className:\"components-builder\"},this.showUserComponents()))));}}]);return Builder;}(Component);export default withData(Builder);","map":{"version":3,"sources":["/home/ironhacker/Documents/M3/droy/src/pages/Builder.js"],"names":["React","Component","withData","UserComponentBase","ComponentsSelectorBar","NavBar","Loading","DragDropContext","Droppable","Draggable","Builder","props","reorder","list","startIndex","endIndex","result","Array","from","splice","removed","onDragEnd","userLayoutObj","updateOrder","destination","items","source","index","componentDidMount","match","getProjectInfo","params","projectId","setState","isLoading","showUserComponents","dataError","length","allComponents","mode","i","c","push","code","provided","snapshot","innerRef","draggableProps","dragHandleProps","componentStyle","componentOptions","droppableProps","placeholder","map","state"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport { withData } from '../contexts/dataContext'\nimport PropTypes from 'prop-types'\nimport UserComponentBase from '../components/droy/UserComponentBase'\nimport ComponentsSelectorBar from '../components/droy/ComponentsSelectorBar'\nimport NavBar from '../components/droy/NavBar'\nimport Loading from '../components/droy/Loading'\nimport '../styles/builder.css'\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\n\n\nclass Builder extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      isLoading: true\n    }\n  }\n\n  // a little function to help us with reordering the result\n  reorder = (list, startIndex, endIndex) => {\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    return result;\n  };\n\n  onDragEnd = (result) => {\n    const { userLayoutObj, updateOrder } = this.props\n    if (result.destination) {\n      const items = this.reorder(\n        userLayoutObj,\n        result.source.index,\n        result.destination.index\n      )\n      updateOrder(items)\n    }\n  }\n\n  /* Updates data context with the actual project information */\n  componentDidMount = async () => {\n    const { match, getProjectInfo } = this.props\n    await getProjectInfo(match.params.projectId)\n    this.setState({ isLoading: false })\n  }\n\n  /* Loops over project info in data context to print user components */\n  /* If not components found, prints a pretty message */\n  showUserComponents = () => {\n    const { userLayoutObj, dataError } = this.props\n    if (!userLayoutObj.length) return (\n      <div className='empty-component-base'>\n        <img className='image-emptyBuilder' src='/img/empty-icon.png' alt='empty-icon' />\n        <p className='text-noComponents'>Start picking one component from the left!</p>\n      </div>)\n    if (dataError) return <div>{dataError}</div>\n\n    const allComponents = []\n    if (this.props.mode === 'edit') {\n      let i = 0\n      for (const c of userLayoutObj) {\n        allComponents.push(\n          <Draggable key={c.code} draggableId={c.code} index={i}>\n            {(provided, snapshot) => (\n              <div ref={provided.innerRef} {...provided.draggableProps} {...provided.dragHandleProps}>\n                <UserComponentBase componentStyle={c.componentStyle} componentOptions={c.componentOptions} code={c.code} key={c.code} />\n              </div>\n            )}\n          </Draggable>\n        )\n        i += 1\n      }\n      return (\n        <Droppable key={i} droppableId=\"droppable\">\n          {(provided, snapshot) => (\n            <div {...provided.droppableProps} ref={provided.innerRef}>\n              {[...allComponents]}\n              {provided.placeholder}\n            </div>\n          )}\n        </Droppable>)\n    } else {\n      return userLayoutObj.map(c => {\n        return <UserComponentBase componentStyle={c.componentStyle} componentOptions={c.componentOptions} code={c.code} key={c.code} />\n      })\n    }\n  }\n\n  render() {\n    const { mode } = this.props\n    const { isLoading } = this.state\n    return (\n      <div>\n        <NavBar withOptions />\n        <div className=\"main-builder\">\n          {isLoading && <div className='loading-container'><Loading /></div>}\n          {!isLoading && mode === \"edit\" && <ComponentsSelectorBar />}\n          <DragDropContext onDragEnd={this.onDragEnd}>\n            {!isLoading && <div className=\"components-builder\">{this.showUserComponents()}</div>}\n          </DragDropContext>\n\n        </div>\n      </div>\n    )\n  }\n}\n\nBuilder.propTypes = {\n  userLayoutObj: PropTypes.array,\n  saveInfoToContext: PropTypes.func\n}\n\nexport default withData(Builder)\n"]},"metadata":{},"sourceType":"module"}